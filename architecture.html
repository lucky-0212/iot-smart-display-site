<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Architecture | IoT Smart Display Board</title>
  <link rel="stylesheet" href="../assets/css/style.css">
  <script defer src="../assets/js/main.js"></script>
</head>
<body>
  <div id="navbar"></div>
  <main class="container">
    
<section class="card">
  <h2>System Architecture</h2>
  <p>The system uses a cloud or local broker/server with deviceâ€‘level authentication.</p>
  <div class="grid">
    <div class="card" style="grid-column: span 7">
      <h3>Data Flow</h3>
      <ol>
        <li>Admin publishes a notice via Web/Mobile app.</li>
        <li>Server validates, stores, and pushes via MQTT/WebSocket to subscribed devices.</li>
        <li>ESP32 receives message, prioritizes (alert > high > normal), renders on P10.</li>
      </ol>
      <div class="callout">
        <b>Protocols:</b> MQTT (pub/sub), HTTPS REST (CRUD for messages), optional WebSocket live stream.
      </div>
    </div>
    <div class="card" style="grid-column: span 5">
      <h3>Topics & Endpoints</h3>
      <table class="table">
        <thead><tr><th>Channel</th><th>Path / Topic</th><th>Notes</th></tr></thead>
        <tbody>
          <tr><td>MQTT</td><td><code>display/{deviceId}/inbox</code></td><td>Publish JSON notices</td></tr>
          <tr><td>MQTT</td><td><code>display/{deviceId}/ack</code></td><td>Device ack & health</td></tr>
          <tr><td>HTTP</td><td><code>POST /api/messages</code></td><td>Create new notice</td></tr>
          <tr><td>HTTP</td><td><code>GET /api/messages?active=true</code></td><td>Fetch current queue</td></tr>
        </tbody>
      </table>
    </div>
  </div>
</section>
<section class="card">
  <h2>Message Model</h2>
  <pre id="msg-json">{
  "id": "uuid",
  "text": "Exam starts 10:00 AM",
  "priority": "high|normal|low|alert",
  "expiresAt": "2025-09-15T10:00:00Z",
  "speed": 80,
  "repeat": 2,
  "effects": ["scroll-left"],
  "line": 0
}</pre>
  <button class="btn" onclick="copyText('msg-json')">Copy JSON</button>
</section>

  </main>
  <div id="footer"></div>
</body>
</html>